{% extends "base.html" %}

{% block title %}{{ action }} Movement - Inventory Management{% endblock %}

{% block content %}
<div class="page-header">
    <div>
        <h1><i class="fas fa-truck"></i> {{ action }} Product Movement</h1>
        <p class="subtitle">{% if movement %}Update movement details{% else %}Record a new product movement{% endif %}</p>
    </div>
</div>

<div class="form-container">
    <form method="POST" class="form">
        <div class="form-group">
            <label for="product_id">Product <span class="required">*</span></label>
            <select id="product_id" name="product_id" class="form-control" required>
                <option value="">Select a product</option>
                {% for product in products %}
                <option value="{{ product.product_id }}" 
                        {% if movement and movement.product_id == product.product_id %}selected{% endif %}>
                    {{ product.name }} ({{ product.product_id }})
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="from_location">From Location</label>
                <select id="from_location" name="from_location" class="form-control">
                    <option value="">External/New Stock</option>
                    {% for location in locations %}
                    <option value="{{ location.location_id }}" 
                            {% if movement and movement.from_location == location.location_id %}selected{% endif %}>
                        {{ location.name }} ({{ location.location_id }})
                    </option>
                    {% endfor %}
                </select>
                <small class="form-help">Leave blank if receiving new stock</small>
            </div>

            <div class="form-group">
                <label for="to_location">To Location</label>
                <select id="to_location" name="to_location" class="form-control">
                    <option value="">External/Sale</option>
                    {% for location in locations %}
                    <option value="{{ location.location_id }}" 
                            {% if movement and movement.to_location == location.location_id %}selected{% endif %}>
                        {{ location.name }} ({{ location.location_id }})
                    </option>
                    {% endfor %}
                </select>
                <small class="form-help">Leave blank if selling/removing stock</small>
            </div>
        </div>

        <div class="form-group">
            <label for="qty">Quantity <span class="required">*</span></label>
            <input type="number" 
                   id="qty" 
                   name="qty" 
                   class="form-control" 
                   value="{{ movement.qty if movement else '' }}" 
                   min="1"
                   required>
            <small class="form-help">Number of units to move</small>
        </div>

        <div class="alert alert-info">
            <i class="fas fa-info-circle"></i>
            <strong>Note:</strong> At least one location (From or To) must be specified. Leave "From" blank for new stock arrival, or leave "To" blank for sales/removal.
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">
                <i class="fas fa-save"></i> {{ action }} Movement
            </button>
            <a href="{{ url_for('movements') }}" class="btn btn-secondary">
                <i class="fas fa-times"></i> Cancel
            </a>
        </div>
    </form>
</div>
{% endblock %}